---
layout: vimdoc
helpname: 'textprop'
---
<div id='vimCodeElement'>
<a class="Constant" href="textprop.html" name="textprop.txt">textprop.txt</a>&nbsp;&nbsp;For&nbsp;<span class="Identifier">Vim version 8.1.</span>&nbsp;&nbsp;Last change: 2019 May 12<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Identifier">VIM REFERENCE MANUAL&nbsp;&nbsp;&nbsp;&nbsp;by Bram Moolenaar</span><br>
<br>
<br>
Displaying text with properties attached.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="textprop.html#textprop" name="textprop">textprop</a>&nbsp;<a class="Constant" href="textprop.html#text-properties" name="text-properties">text-properties</a><br>
<br>
<span class="Statement">THIS IS UNDER DEVELOPMENT - ANYTHING MAY STILL CHANGE&nbsp;&nbsp;</span><a class="Constant" href="textprop.html#E967" name="E967">E967</a><br>
<br>
What is not working yet:<br>
- Adjusting column/length when inserting text<br>
- Text properties spanning more than one line<br>
- prop_find()<br>
<br>
<br>
1. Introduction&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="textprop.html#text-prop-intro">text-prop-intro</a><br>
2. Functions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="textprop.html#text-prop-functions">text-prop-functions</a><br>
3. When text changes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="textprop.html#text-prop-changes">text-prop-changes</a><br>
<br>
<br>
<span class="Special">{not able to use text properties when the&nbsp;</span><a class="Identifier" href="various.html#+textprop">+textprop</a><span class="Special">&nbsp;feature was</span><br>
<span class="Special">disabled at compile time}</span><br>
<br>
<span class="PreProc">==============================================================================</span><br>
1. Introduction&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="textprop.html#text-prop-intro" name="text-prop-intro">text-prop-intro</a><br>
<br>
Text properties can be attached to text in a buffer.&nbsp;&nbsp;They will move with the<br>
text: If lines are deleted or inserted the properties move with the text they<br>
are attached to.&nbsp;&nbsp;Also when inserting/deleting text in the line before the<br>
text property.&nbsp;&nbsp;And when inserting/deleting text inside the text property, it<br>
will increase/decrease in size.<br>
<br>
The main use for text properties is to highlight text.&nbsp;&nbsp;This can be seen as a<br>
replacement for syntax highlighting.&nbsp;&nbsp;Instead of defining patterns to match<br>
the text, the highlighting is set by a script, possibly using the output of an<br>
external parser.&nbsp;&nbsp;This only needs to be done once, not every time when<br>
redrawing the screen, thus can be much faster, after the initial cost of<br>
attaching the text properties.<br>
<br>
Text properties can also be used for other purposes to identify text.&nbsp;&nbsp;For<br>
example, add a text property on a function name, so that a search can be<br>
defined to jump to the next/previous function.<br>
<br>
A text property is attached at a specific line and column, and has a specified<br>
length.&nbsp;&nbsp;The property can span multiple lines.<br>
<br>
A text property has these fields:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;id&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a number to be used as desired<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;type&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the name of a property type<br>
<br>
<br>
<span class="PreProc">Property Types</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="textprop.html#E971" name="E971">E971</a><br>
A text property normally has the name of a property type, which defines&nbsp;<br>
how to highlight the text.&nbsp;&nbsp;The property type can have these entries:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;highlight&quot;&nbsp;&nbsp;&nbsp;&nbsp; name of the highlight group to use<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;combine&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when TRUE the text property highlighting is combined<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with any syntax highligting, when omitted or FALSE the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text property highlighting replaces the syntax<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;highlighting<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;priority&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when properties overlap, the one with the highest<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priority will be used.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;start_incl&quot;&nbsp;&nbsp;&nbsp;&nbsp;when TRUE inserts at the start position will be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;included in the text property<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;end_incl&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when TRUE inserts at the end position will be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;included in the text property<br>
<br>
<br>
<span class="PreProc">Example</span><br>
<br>
Suppose line 11 in a buffer has this text (excluding the indent):<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number 123 is smaller than 4567.<br>
<br>
To highlight the numbers in this text:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call prop_type_add('number', {'highlight': 'Constant'})<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call prop_add(11, 12, {'length': 3, 'type': 'number'})<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call prop_add(11, 32, {'length': 4, 'type': 'number'})</div>
<br>
Try inserting or deleting lines above the text, you will see that the text<br>
properties stick to the text, thus the line number is adjusted as needed.<br>
<br>
Setting &quot;start_incl&quot; and &quot;end_incl&quot; is useful when white space surrounds the<br>
text, e.g. for a function name.&nbsp;&nbsp;Using false is useful when the text starts<br>
and/or ends with a specific character, such as the quote surrounding a string.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">func FuncName(arg)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ^^^^^^^^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property with start_incl and end_incl set<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">var = &quot;text&quot;;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^^^^^^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; property with start_incl and end_incl not set<br>
<br>
Nevertheless, when text is inserted or deleted the text may need to be parsed<br>
and the text properties updated.&nbsp;&nbsp;But this can be done asynchronously.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
2. Functions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="textprop.html#text-prop-functions" name="text-prop-functions">text-prop-functions</a><br>
<br>
Manipulating text property types:<br>
<br>
prop_type_add(<span class="Special">{name}</span>,&nbsp;<span class="Special">{props}</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;define a new property type<br>
prop_type_change(<span class="Special">{name}</span>,&nbsp;<span class="Special">{props}</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; change an existing property type<br>
prop_type_delete(<span class="Special">{name}</span>&nbsp;[,&nbsp;<span class="Special">{props}</span>])&nbsp;&nbsp;&nbsp;&nbsp;delete a property type<br>
prop_type_get([<span class="Special">{name}</span>&nbsp;[,&nbsp;<span class="Special">{props}</span>])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get property type values<br>
prop_type_list([<span class="Special">{props}</span>])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get list of property types<br>
<br>
<br>
Manipulating text properties:<br>
<br>
prop_add(<span class="Special">{lnum}</span>,&nbsp;<span class="Special">{col}</span>,&nbsp;<span class="Special">{props}</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add a text property<br>
prop_clear(<span class="Special">{lnum}</span>&nbsp;[,&nbsp;<span class="Special">{lnum-end}</span>&nbsp;[,&nbsp;<span class="Special">{bufnr}</span>]])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove all text properties<br>
prop_find(<span class="Special">{props}</span>&nbsp;[,&nbsp;<span class="Special">{direction}</span>])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;search for a text property<br>
prop_list(<span class="Special">{lnum}</span>&nbsp;[,&nbsp;<span class="Special">{props}</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text properties in&nbsp;<span class="Special">{lnum}</span><br>
prop_remove(<span class="Special">{props}</span>&nbsp;[,&nbsp;<span class="Special">{lnum}</span>&nbsp;[,&nbsp;<span class="Special">{lnum-end}</span>]])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove a text property<br>
<br>
<span class="PreProc">==============================================================================</span><br>
3. When text changes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="textprop.html#text-prop-changes" name="text-prop-changes">text-prop-changes</a><br>
<br>
Vim will do its best to keep the text properties on the text where it was<br>
attached.&nbsp;&nbsp;When inserting or deleting text the properties after the change<br>
will move accordingly.<br>
<br>
When text is deleted and a text property no longer includes any text, it is<br>
deleted.&nbsp;&nbsp;However, a text property that was defined as zero-width will remain,<br>
unless the whole line is deleted.<br>
<br>
When using replace mode, the text properties stay on the same character<br>
positions, even though the characters themselves change.<br>
<br>
To update text properties after the text was changed, install a callback with<br>
<a class="Comment" href="eval.html#listener_add()">listener_add()</a>.&nbsp;&nbsp;E.g, if your plugin does spell checking, you can have the<br>
callback update spelling mistakes in the changed text.&nbsp;&nbsp;Vim will move the<br>
properties below the changed text, so that they still highlight the same text,<br>
thus you don't need to update these.<br>
<br>
<br>
<span class="PreProc">Text property columns are not updated:</span><br>
<br>
- When setting the line with&nbsp;<a class="Identifier" href="eval.html#setline()">setline()</a>&nbsp;or through an interface, such as Lua,<br>
&nbsp;&nbsp;Tcl or Python.&nbsp;&nbsp;Vim does not know what text got inserted or deleted.<br>
<br>
<br>
&nbsp;vim:tw=78:ts=8:noet:ft=help:norl:<br>
</div>
